{% extends 'notes/base.html' %}
{% load static %}

{% block title %}ุฅูุดุงุก ูุซููุฉ ุฌุฏูุฏุฉ{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto mt-6 bg-white shadow-lg rounded-xl p-8">

    <h2 class="text-3xl font-bold text-center text-blue-800 mb-8">โ๏ธ ุฅูุดุงุก ูุซููุฉ ุฌุฏูุฏุฉ</h2>

    {% if success %}
        <div class="bg-green-100 border border-green-400 text-green-800 px-6 py-4 rounded mb-6 text-center shadow">
            โ ุชู ุฅูุดุงุก ุงููุซููุฉ ุจูุฌุงุญ.
            <div class="mt-3 space-y-2">
                <a href="/note/{{ new_note_token }}/" target="_blank" class="block text-blue-700 font-bold underline hover:text-blue-900">
                    ๐ ุนุฑุถ ุงููุซููุฉ
                </a>
                {% if note_pdf_url %}
                    <a href="{{ note_pdf_url }}" download class="block text-green-700 underline font-medium hover:text-green-900">
                        โฌ๏ธ ุชุญููู PDF
                    </a>
                {% endif %}
                {% if img_str %}
                    <div class="flex justify-center mt-4">
                        <img src="data:image/png;base64,{{ img_str }}" alt="QR Code" class="h-32 w-32 rounded border border-gray-300 shadow">
                    </div>
                {% endif %}
            </div>
        </div>
    {% endif %}

    <!-- โ ุงููููุฐุฌ -->
    <form method="post" enctype="multipart/form-data" class="space-y-5">
        {% csrf_token %}

        <div>
            <label class="block text-sm font-bold text-gray-700">๐ ุนููุงู ุงููุซููุฉ</label>
            <input type="text" name="title" required class="mt-1 block w-full border border-gray-300 rounded-md p-2 focus:ring focus:ring-blue-200">
        </div>

        <div>
            <label class="block text-sm font-bold text-gray-700">๐ ูุญุชูู ุงููุซููุฉ</label>
            <textarea name="content" rows="5" required class="mt-1 block w-full border border-gray-300 rounded-md p-2 focus:ring focus:ring-blue-200"></textarea>
        </div>

        <div>
            <label class="block text-sm font-bold text-gray-700">๐ ููุน ุงููุซููุฉ</label>
            <select name="doc_type" class="mt-1 block w-full border border-gray-300 rounded-md p-2" required>
                <option value="">-- ุงุฎุชุฑ ููุน ุงููุซููุฉ --</option>
                <option value="official">๐ ูุชุงุจ ุฑุณูู</option>
                <option value="administrative">๐ ุฃูุฑ ุฅุฏุงุฑู</option>
                <option value="circular">๐ข ุชุนููู</option>
            </select>
        </div>

        <div>
            <label class="block text-sm font-bold text-gray-700">๐ ุฌูุฉ ุงููุซููุฉ</label>
            <select name="direction" class="mt-1 block w-full border border-gray-300 rounded-md p-2" required>
                <option value="outgoing">๐ค ุตุงุฏุฑุฉ</option>
                <option value="incoming">๐ฅ ูุงุฑุฏุฉ</option>
            </select>
        </div>

        <div>
            <label class="block text-sm font-bold text-gray-700">โณ ุชุงุฑูุฎ ุงูุงูุชูุงุก (ุงุฎุชูุงุฑู)</label>
            <input type="datetime-local" name="expiry_date" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
        </div>

        <div>
            <label class="block text-sm font-bold text-gray-700">๐ข ุงุณู ุงูุฌูุฉ ุงููุตุฏุฑุฉ</label>
            <input type="text" name="issuer_name" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
        </div>

        <div>
            <label class="block text-sm font-bold text-gray-700">๐งโ๐ผ ุฅูู (ุงูุฌูุฉ ุงููุณุชููุฉ)</label>
            <input type="text" name="recipient_name" required class="mt-1 block w-full border border-gray-300 rounded-md p-2 focus:ring focus:ring-blue-200">
        </div>

        <div>
            <label class="block text-sm font-bold text-gray-700">๐ท ุงููุณูู (Tags)</label>
            <select name="tags" multiple class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                {% for tag in tags %}
                    <option value="{{ tag.id }}">{{ tag.name }}</option>
                {% endfor %}
            </select>
            <p class="text-xs text-gray-500 mt-1">ููููู ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ูุณู ุจุงูุถุบุท ุนูู Ctrl</p>
        </div>

        <div>
            <label class="block text-sm font-bold text-gray-700">๐ ูุฑูู (PDF ุฃู ุตูุฑุฉ)</label>
            <input type="file" name="attachment" class="mt-1 block w-full border border-gray-300 rounded-md p-2 bg-gray-50">
        </div>

        <!-- โ ุฒุฑ ุฅูุดุงุก -->
        <div class="text-center mt-8">
            <button type="submit" class="bg-blue-700 text-white px-6 py-3 rounded-md text-lg font-semibold hover:bg-blue-800 transition-all">
                โ ุฅูุดุงุก ุงููุซููุฉ
            </button>
        </div>
    </form>
</div>
{% endblock %}
