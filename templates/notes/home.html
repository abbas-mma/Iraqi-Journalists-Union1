{% extends 'notes/base.html' %}
{% load static %}
{% block content %}

<!-- ุนููุงู ุงูุตูุญุฉ -->
<h2 class="text-3xl font-bold text-center mb-6 text-blue-800">๐ ููุญุฉ ุงูุชุญูู ุงูุฑุฆูุณูุฉ</h2>

<!-- ุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑุฉ -->
<div class="flex flex-wrap justify-center gap-3 mb-6">
    <a href="{% url 'user_management' %}" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">โ ุฅุถุงูุฉ ูุณุชุฎุฏู</a>
    <a href="{% url 'user_management' %}" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">๐ฅ ุนุฑุถ/ุญุฐู ุงููุณุชุฎุฏููู</a>
    <a href="{% url 'role_change_log' %}" class="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600">๐ ุณุฌู ุงูุตูุงุญูุงุช</a>
    <a href="{% url 'login_history' %}" class="bg-gray-700 text-white px-4 py-2 rounded hover:bg-gray-800">๐ต๏ธ ุณุฌู ุงูุฏุฎูู</a>
</div>

<!-- ุจุทุงูุงุช ุงูุฅุญุตุงุฆูุงุช -->
<div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-8">
    <div class="bg-yellow-300 p-4 rounded shadow">
        <h4 class="font-bold text-lg flex items-center gap-1">๐ ุฅุดุนุงุฑุงุช</h4>
        <ul class="mt-2 list-disc list-inside text-sm">
            <li>ุฑุงุฌุน ุงููุซุงุฆู ุงูููุชููุฉ</li>
            <li>ุชุฃูุฏ ูู ุชุญุฏูุซ ุจูุงูุงุช ุงููุณุชุฎุฏููู</li>
        </ul>
    </div>

    <div class="bg-purple-100 p-4 rounded shadow text-center">
        <h4 class="text-lg font-bold">ุนุฏุฏ ุงููุณุชุฎุฏููู</h4>
        <p class="text-2xl mt-2">{{ stats.users }}</p>
    </div>

    <div class="bg-green-100 p-4 rounded shadow text-center">
        <h4 class="text-lg font-bold">ุงููุซุงุฆู ุงููุดุทุฉ</h4>
        <p class="text-2xl mt-2">{{ stats.active }}</p>
    </div>

    <div class="bg-yellow-100 p-4 rounded shadow text-center">
        <h4 class="text-lg font-bold">ุงููุซุงุฆู ุงูููุชููุฉ</h4>
        <p class="text-2xl mt-2">{{ stats.expired }}</p>
    </div>

    <div class="bg-blue-100 p-4 rounded shadow text-center">
        <h4 class="text-lg font-bold">ุงููุซุงุฆู ุงููุคุฑุดูุฉ</h4>
        <p class="text-2xl mt-2">{{ stats.archived }}</p>
    </div>
</div>

<!-- ุจุญุซ ูุชูุฏู -->
<form method="get" class="bg-white p-4 rounded shadow mb-6 flex flex-wrap items-center gap-3">
    <input type="text" name="q" placeholder="ุจุญุซ ุจุงูุนููุงู..." value="{{ request.GET.q }}" class="border p-2 rounded flex-1" />
    <select name="doc_type" class="border p-2 rounded">
        <option value="">ูู ุงูุฃููุงุน</option>
        <option value="official" {% if request.GET.doc_type == 'official' %}selected{% endif %}>ุฑุณูู</option>
        <option value="internal" {% if request.GET.doc_type == 'internal' %}selected{% endif %}>ุฏุงุฎูู</option>
        <option value="urgent" {% if request.GET.doc_type == 'urgent' %}selected{% endif %}>ุนุงุฌู</option>
    </select>
    <input type="date" name="created_at" value="{{ request.GET.created_at }}" class="border p-2 rounded" />
    <button type="submit" class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-black">ุจุญุซ ูุชูุฏู</button>
</form>

<!-- ุฒุฑ ุฅูุดุงุก ูุซููุฉ -->
<div class="text-right mb-4">
    <a href="{% url 'create_note' %}" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">โ ุฅูุดุงุก ูุซููุฉ ุฌุฏูุฏุฉ</a>
</div>

<!-- ุฌุฏูู ุงููุซุงุฆู -->
<div class="overflow-x-auto bg-white rounded shadow">
    <table class="min-w-full text-sm text-right">
        <thead class="bg-gray-100">
            <tr>
                <th class="px-4 py-2">ุงูุนููุงู</th>
                <th class="px-4 py-2">ุงูููุน</th>
                <th class="px-4 py-2">ุงูุญุงูุฉ</th>
                <th class="px-4 py-2">ุชุงุฑูุฎ ุงูุฅูุดุงุก</th>
                <th class="px-4 py-2">ุนุฑุถ</th>
                {% if user_profile.role in 'admin supervisor' %}
                <th class="px-4 py-2">ุฃุฑุดูุฉ</th>
                <th class="px-4 py-2">ุญุฐู</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for note in notes %}
            <tr class="border-t hover:bg-gray-50">
                <td class="px-4 py-2">{{ note.title }}</td>
                <td class="px-4 py-2">{{ note.get_doc_type_display }}</td>
                <td class="px-4 py-2">
                    {% if note.is_archived %} ูุคุฑุดูุฉ
                    {% elif note.expiry_date and note.expiry_date < now %} ููุชููุฉ
                    {% else %} ูุดุทุฉ
                    {% endif %}
                </td>
                <td class="px-4 py-2">{{ note.created_at|date:"Y-m-d" }}</td>
                <td class="px-4 py-2">
                    <a href="{% url 'note_detail' note.access_token %}" class="text-blue-600 hover:underline">ุนุฑุถ</a>
                </td>
                {% if user_profile.role in 'admin supervisor' %}
                <td class="px-4 py-2">
                    <a href="{% url 'archive_note' note.id %}" class="text-yellow-600 hover:underline">ุฃุฑุดูุฉ</a>
                </td>
                <td class="px-4 py-2">
                    <a href="{% url 'delete_note' note.id %}" class="text-red-600 hover:underline">ุญุฐู</a>
                </td>
                {% endif %}
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" class="text-center text-gray-400 py-4">ูุง ุชูุฌุฏ ูุซุงุฆู</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- ุชูุฒูุน ุงููุซุงุฆู -->
<div class="mt-10 text-center">
    <h3 class="text-lg font-bold text-blue-800 mb-2">๐ ุชูุฒูุน ุงููุซุงุฆู</h3>
    <div class="flex justify-center space-x-4 rtl:space-x-reverse">
        <div class="flex items-center gap-1"><div class="w-4 h-4 bg-green-400 rounded-full"></div><span>ุงููุดุทุฉ</span></div>
        <div class="flex items-center gap-1"><div class="w-4 h-4 bg-blue-400 rounded-full"></div><span>ุงููุคุฑุดูุฉ</span></div>
        <div class="flex items-center gap-1"><div class="w-4 h-4 bg-yellow-400 rounded-full"></div><span>ุงูููุชููุฉ</span></div>
    </div>
</div>

<!-- ุขุฎุฑ ุชุบููุฑุงุช ุงูุตูุงุญูุงุช -->
<div class="mt-8 bg-white p-4 rounded shadow">
    <h4 class="text-lg font-bold text-blue-700 mb-2">๐๏ธ ุขุฎุฑ ุชุบููุฑุงุช ุงูุตูุงุญูุงุช</h4>
    <p class="text-gray-500">ูุง ุชูุฌุฏ ุชุบููุฑุงุช ุญุฏูุซุฉ.</p>
</div>

{% endblock %}
