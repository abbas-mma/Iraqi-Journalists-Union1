<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWA Checker - ÙØ­Øµ Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        h1 {
            text-align: center;
            color: #1e40af;
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .check-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .check-item.success {
            background: #ecfdf5;
            border-left: 4px solid #10b981;
        }

        .check-item.error {
            background: #fef2f2;
            border-left: 4px solid #ef4444;
        }

        .check-item.warning {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
        }

        .icon {
            margin-left: 1rem;
            font-size: 1.5rem;
        }

        .message {
            flex: 1;
            font-weight: 600;
        }

        .details {
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.5rem;
        }

        .actions {
            margin-top: 2rem;
            text-align: center;
        }

        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            margin: 0.5rem;
            background: #1e40af;
            color: white;
            text-decoration: none;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #1e3a8a;
            transform: translateY(-2px);
        }

        .score {
            text-align: center;
            margin: 2rem 0;
        }

        .score-circle {
            display: inline-block;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            color: white;
            margin: 1rem;
        }

        .score-excellent { background: #10b981; }
        .score-good { background: #f59e0b; }
        .score-poor { background: #ef4444; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ” ÙØ­Øµ Ø¬Ø§Ù‡Ø²ÙŠØ© PWA</h1>
    
    <div class="score">
        <div id="scoreCircle" class="score-circle">
            <span id="scoreText">0%</span>
        </div>
        <div id="scoreLabel">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</div>
    </div>

    <div id="checkResults">
        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù‡Ù†Ø§ -->
    </div>

    <div class="actions">
        <a href="https://www.pwabuilder.com/" target="_blank" class="btn">
            ğŸš€ Ø¥Ù†Ø´Ø§Ø¡ APK Ø¨Ù€ PWA Builder
        </a>
        <a href="#" id="downloadReport" class="btn">
            ğŸ“„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        </a>
        <a href="/" class="btn">
            ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        </a>
    </div>
</div>

<script>
let score = 0;
let totalChecks = 0;
let checks = [];

function addCheck(status, message, details) {
    totalChecks++;
    if (status === 'success') score++;
    
    checks.push({
        status: status,
        message: message,
        details: details
    });
    
    const resultsDiv = document.getElementById('checkResults');
    const checkDiv = document.createElement('div');
    checkDiv.className = `check-item ${status}`;
    
    const icon = status === 'success' ? 'âœ…' : status === 'error' ? 'âŒ' : 'âš ï¸';
    
    checkDiv.innerHTML = `
        <span class="icon">${icon}</span>
        <div>
            <div class="message">${message}</div>
            ${details ? `<div class="details">${details}</div>` : ''}
        </div>
    `;
    
    resultsDiv.appendChild(checkDiv);
    
    updateScore();
}

function updateScore() {
    const percentage = Math.round((score / totalChecks) * 100);
    const scoreCircle = document.getElementById('scoreCircle');
    const scoreText = document.getElementById('scoreText');
    const scoreLabel = document.getElementById('scoreLabel');
    
    scoreText.textContent = percentage + '%';
    
    if (percentage >= 80) {
        scoreCircle.className = 'score-circle score-excellent';
        scoreLabel.textContent = 'Ù…Ù…ØªØ§Ø²! Ø¬Ø§Ù‡Ø² Ù„Ø¥Ù†Ø´Ø§Ø¡ APK';
    } else if (percentage >= 60) {
        scoreCircle.className = 'score-circle score-good';
        scoreLabel.textContent = 'Ø¬ÙŠØ¯! Ø¨Ø¹Ø¶ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ù…Ø·Ù„ÙˆØ¨Ø©';
    } else {
        scoreCircle.className = 'score-circle score-poor';
        scoreLabel.textContent = 'ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†Ø§Øª ÙƒØ«ÙŠØ±Ø©';
    }
}

function runChecks() {
    // ÙØ­Øµ Manifest
    fetch('/static/manifest.json')
        .then(response => {
            if (response.ok) {
                addCheck('success', 'Ù…Ù„Ù Manifest Ù…ÙˆØ¬ÙˆØ¯', 'ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ manifest.json');
                return response.json();
            } else {
                addCheck('error', 'Ù…Ù„Ù Manifest Ù…ÙÙ‚ÙˆØ¯', 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ manifest.json');
                return null;
            }
        })
        .then(manifest => {
            if (manifest) {
                // ÙØ­Øµ Ù…Ø­ØªÙˆÙŠØ§Øª Manifest
                if (manifest.name) {
                    addCheck('success', 'Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø­Ø¯Ø¯', `Ø§Ù„Ø§Ø³Ù…: ${manifest.name}`);
                } else {
                    addCheck('error', 'Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…ÙÙ‚ÙˆØ¯', 'ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙÙŠ manifest.json');
                }
                
                if (manifest.icons && manifest.icons.length > 0) {
                    addCheck('success', 'Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø©', `Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª: ${manifest.icons.length}`);
                } else {
                    addCheck('error', 'Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù…ÙÙ‚ÙˆØ¯Ø©', 'ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¨Ø£Ø­Ø¬Ø§Ù… Ù…Ø®ØªÙ„ÙØ©');
                }
                
                if (manifest.start_url) {
                    addCheck('success', 'Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù…Ø­Ø¯Ø¯', `Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©: ${manifest.start_url}`);
                } else {
                    addCheck('warning', 'Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù…ÙÙ‚ÙˆØ¯', 'ÙŠÙÙ†ØµØ­ Ø¨ØªØ­Ø¯ÙŠØ¯ start_url');
                }
                
                if (manifest.display === 'standalone' || manifest.display === 'fullscreen') {
                    addCheck('success', 'ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ù…Ù†Ø§Ø³Ø¨', `Ø§Ù„ÙˆØ¶Ø¹: ${manifest.display}`);
                } else {
                    addCheck('warning', 'ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ ØºÙŠØ± Ù…Ø­Ø³Ù†', 'ÙŠÙÙ†ØµØ­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… standalone');
                }
                
                if (manifest.theme_color) {
                    addCheck('success', 'Ù„ÙˆÙ† Ø§Ù„Ø«ÙŠÙ… Ù…Ø­Ø¯Ø¯', `Ø§Ù„Ù„ÙˆÙ†: ${manifest.theme_color}`);
                } else {
                    addCheck('warning', 'Ù„ÙˆÙ† Ø§Ù„Ø«ÙŠÙ… Ù…ÙÙ‚ÙˆØ¯', 'ÙŠÙÙ†ØµØ­ Ø¨ØªØ­Ø¯ÙŠØ¯ theme_color');
                }
            }
        })
        .catch(() => {
            addCheck('error', 'Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Manifest', 'ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ù…Ù„Ù manifest.json');
        });

    // ÙØ­Øµ Service Worker
    if ('serviceWorker' in navigator) {
        fetch('/static/sw.js')
            .then(response => {
                if (response.ok) {
                    addCheck('success', 'Service Worker Ù…ÙˆØ¬ÙˆØ¯', 'ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ sw.js');
                } else {
                    addCheck('error', 'Service Worker Ù…ÙÙ‚ÙˆØ¯', 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ sw.js');
                }
            })
            .catch(() => {
                addCheck('error', 'Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Service Worker', 'ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ sw.js');
            });
    } else {
        addCheck('error', 'Service Worker ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…', 'Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Service Workers');
    }

    // ÙØ­Øµ HTTPS
    if (location.protocol === 'https:') {
        addCheck('success', 'HTTPS Ù…ÙØ¹Ù„', 'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ³ØªØ®Ø¯Ù… Ø§ØªØµØ§Ù„ Ø¢Ù…Ù†');
    } else {
        addCheck('warning', 'HTTPS ØºÙŠØ± Ù…ÙØ¹Ù„', 'HTTPS Ù…Ø·Ù„ÙˆØ¨ Ù„Ù„Ù†Ø´Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ');
    }

    // ÙØ­Øµ Ø§Ù„ØªØ¬Ø§ÙˆØ¨
    const viewport = document.querySelector('meta[name="viewport"]');
    if (viewport) {
        addCheck('success', 'Ø§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…ÙØ¹Ø¯ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', 'viewport meta tag Ù…ÙˆØ¬ÙˆØ¯');
    } else {
        addCheck('error', 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…ÙÙ‚ÙˆØ¯Ø©', 'viewport meta tag Ù…Ø·Ù„ÙˆØ¨');
    }

    // ÙØ­Øµ Ø§Ù„Ø®Ø·ÙˆØ·
    const arabicFont = document.querySelector('link[href*="Cairo"]') || 
                      document.querySelector('link[href*="arabic"]') ||
                      getComputedStyle(document.body).fontFamily.includes('Cairo');
    if (arabicFont) {
        addCheck('success', 'Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ù…Ø­Ø³Ù†', 'ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø®Ø· Ø¹Ø±Ø¨ÙŠ Ù…Ù†Ø§Ø³Ø¨');
    } else {
        addCheck('warning', 'Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ ØºÙŠØ± Ù…Ø­Ø³Ù†', 'ÙŠÙÙ†ØµØ­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø· Ø¹Ø±Ø¨ÙŠ Ø¬ÙŠØ¯');
    }

    // ÙØ­Øµ Ø§Ù„Ø£Ø¯Ø§Ø¡
    setTimeout(() => {
        const loadTime = performance.now();
        if (loadTime < 3000) {
            addCheck('success', 'Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ù…ØªØ§Ø²Ø©', `ÙˆÙ‚Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„: ${Math.round(loadTime)}ms`);
        } else if (loadTime < 5000) {
            addCheck('warning', 'Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¬ÙŠØ¯Ø©', `ÙˆÙ‚Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„: ${Math.round(loadTime)}ms`);
        } else {
            addCheck('error', 'Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø·ÙŠØ¦Ø©', `ÙˆÙ‚Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„: ${Math.round(loadTime)}ms`);
        }
    }, 1000);
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„ÙØ­ÙˆØµØ§Øª
document.addEventListener('DOMContentLoaded', runChecks);

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
document.getElementById('downloadReport').addEventListener('click', function(e) {
    e.preventDefault();
    
    const reportData = {
        timestamp: new Date().toISOString(),
        score: Math.round((score / totalChecks) * 100),
        checks: checks,
        recommendations: [
            'ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¨Ø§Ù„Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©',
            'Ø§Ø³ØªØ®Ø¯Ù… HTTPS Ù„Ù„Ù†Ø´Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ',
            'Ø§Ø®ØªØ¨Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ø£Ø¬Ù‡Ø²Ø© Ù…Ø®ØªÙ„ÙØ©',
            'Ø­Ø³Ù† Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„',
            'Ø£Ø¶Ù offline functionality'
        ]
    };
    
    const blob = new Blob([JSON.stringify(reportData, null, 2)], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'pwa-report.json';
    a.click();
    URL.revokeObjectURL(url);
});
</script>

</body>
</html>
